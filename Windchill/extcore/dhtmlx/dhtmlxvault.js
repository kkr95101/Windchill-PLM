/*
Product Name: dhtmlxVault 
Version: 2.3 
Edition: Professional 
License: content of this file is covered by DHTMLX Commercial or Enterprise license. Usage without proper license is prohibited. To obtain it contact sales@dhtmlx.com
Copyright UAB Dinamenta http://www.dhtmlx.com
*/

if(typeof(window.dhx4)=="undefined"){window.dhx4={version:"4.0.3",skin:null,skinDetect:function(b){var c=document.createElement("DIV");c.className=b+"_skin_detect";if(document.body.firstChild){document.body.insertBefore(c,document.body.firstChild)}else{document.body.appendChild(c)}var a=c.offsetWidth;c.parentNode.removeChild(c);c=null;return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[a]||null},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var c=this.first();for(var b in this.data){c=Math.max(c,this.data[b])}return c},reserve:function(a){this.data[a]=this.last()+this.step;return this.data[a]},clear:function(a){if(this.data[a]!=null){this.data[a]=null;delete this.data[a]}}},s2b:function(a){return(a==true||a==1||a=="true"||a=="1"||a=="yes"||a=="y")},trim:function(a){return String(a).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},template:function(b,c,a){return b.replace(/#([a-zA-Z0-9_-]{1,})#/g,function(e,d){if(d.length>0&&typeof(c[d])!="undefined"){if(a==true){return window.dhx4.trim(c[d])}return String(c[d])}return""})},absLeft:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._aOfs(a).left},absTop:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._aOfs(a).top},_aOfsSum:function(a){var c=0,b=0;while(a){c=c+parseInt(a.offsetTop);b=b+parseInt(a.offsetLeft);a=a.offsetParent}return{top:c,left:b}},_aOfsRect:function(d){var g=d.getBoundingClientRect();var h=document.body;var b=document.documentElement;var a=window.pageYOffset||b.scrollTop||h.scrollTop;var e=window.pageXOffset||b.scrollLeft||h.scrollLeft;var f=b.clientTop||h.clientTop||0;var i=b.clientLeft||h.clientLeft||0;var j=g.top+a-f;var c=g.left+e-i;return{top:Math.round(j),left:Math.round(c)}},_aOfs:function(a){if(a.getBoundingClientRect){return this._aOfsRect(a)}else{return this._aOfsSum(a)}},_isObj:function(a){return(a!=null&&typeof(a)=="object"&&typeof(a.length)=="undefined")},_copyObj:function(d){if(this._isObj(d)){var c={};for(var b in d){if(typeof(d[b])=="object"&&d[b]!=null){c[b]=this._copyObj(d[b])}else{c[b]=d[b]}}}else{var c=[];for(var b=0;b<d.length;b++){if(typeof(d[b])=="object"&&d[b]!=null){c[b]=this._copyObj(d[b])}else{c[b]=d[b]}}}return c},screenDim:function(){var a=(navigator.userAgent.indexOf("MSIE")>=0);var b={};b.left=document.body.scrollLeft;b.right=b.left+(window.innerWidth||document.body.clientWidth);b.top=Math.max((a?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);b.bottom=b.top+(a?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight);return b},selectTextRange:function(d,g,b){d=(typeof(d)=="string"?document.getElementById(d):d);var a=d.value.length;g=Math.max(Math.min(g,a),0);b=Math.min(b,a);if(d.setSelectionRange){try{d.setSelectionRange(g,b)}catch(f){}}else{if(d.createTextRange){var c=d.createTextRange();c.moveStart("character",g);c.moveEnd("character",b-a);try{c.select()}catch(f){}}}},transData:null,transDetect:function(){if(this.transData==null){this.transData={transProp:false,transEv:null};var c={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var b in c){if(this.transData.transProp==false&&document.documentElement.style[b]!=null){this.transData.transProp=b;this.transData.transEv=c[b]}}c=null}return this.transData}};window.dhx4.isIE=(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE6=(window.XMLHttpRequest==null&&navigator.userAgent.indexOf("MSIE")>=0);window.dhx4.isIE7=(navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0);window.dhx4.isOpera=(navigator.userAgent.indexOf("Opera")>=0);window.dhx4.isChrome=(navigator.userAgent.indexOf("Chrome")>=0);window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0);window.dhx4.isFF=(navigator.userAgent.indexOf("Firefox")>=0);window.dhx4.isIPad=(navigator.userAgent.search(/iPad/gi)>=0)}if(typeof(window.dhx4.ajax)=="undefined"){window.dhx4.ajax={cache:false,method:"post",get:function(a,b){this._call("GET",a,null,true,b)},getSync:function(a){return this._call("GET",a,null,false)},post:function(b,a,c){if(arguments.length==1){a=""}else{if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a])=="function")){c=a;a=""}else{a=String(a)}}this._call("POST",b,a,true,c)},postSync:function(b,a){a=(a==null?"":String(a));return this._call("POST",b,a,false)},getLong:function(a,b){this._call("GET",a,null,true,b,{url:a})},postLong:function(b,a,c){if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a]))){c=a;a=""}this._call("POST",b,a,true,c,{url:b,postData:a})},_call:function(h,b,a,f,e,d){var c=(window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));var g=(navigator.userAgent.match(/AppleWebKit/)!=null&&navigator.userAgent.match(/Qt/)!=null&&navigator.userAgent.match(/Safari/)!=null);if(f==true){c.onreadystatechange=function(){if((c.readyState==4&&c.status==200)||(g==true&&c.readyState==3)){window.setTimeout(function(){if(typeof(e)=="function"){e.apply(window,[{xmlDoc:c}])}if(d!=null){if(typeof(d.postData)!="undefined"){dhx4.ajax.postLong(d.url,d.postData,e)}else{dhx4.ajax.getLong(d.url,e)}}e=null;c=null},1)}}}if(h=="GET"&&this.cache!=true){b+=(b.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()}c.open(h,b,f);if(h=="POST"){c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(this.cache!=true){a+=(a.length>0?"&":"")+"dhxr"+new Date().getTime()}}else{a=null}c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.send(a);if(!f){return{xmlDoc:c}}}}}if(typeof(window.dhx4._enableDataLoading)=="undefined"){window.dhx4._enableDataLoading=function(obj,initObj,xmlToJson,xmlRootTag,mode){if(mode=="clear"){for(var a in obj._dhxdataload){obj._dhxdataload[a]=null;delete obj._dhxdataload[a]}obj._loadData=null;obj._dhxdataload=null;obj.load=null;obj.loadStruct=null;obj=null;return}obj._dhxdataload={initObj:initObj,xmlToJson:xmlToJson,xmlRootTag:xmlRootTag,onBeforeXLS:null};obj._loadData=function(data,loadParams,onLoad){if(arguments.length==2){onLoad=loadParams;loadParams=null}var obj=null;if(arguments.length==3){onLoad=arguments[2]}if(typeof(data)=="string"){var k=data.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");var tag=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(tag.test(k.replace(/^<\?xml[^\?]*\?>\s*/,""))){if(window.DOMParser){obj=(new window.DOMParser()).parseFromString(data,"text/xml")}else{if(typeof(window.ActiveXObject)!="undefined"){obj=new window.ActiveXObject("Microsoft.XMLDOM");obj.async="false";obj.loadXML(data)}}if(obj!=null){obj=this[this._dhxdataload.xmlToJson].apply(this,[obj])}}if(obj==null&&(k.match(/^\{.*\}$/)!=null||k.match(/^\[.*\]$/)!=null)){try{eval("dhx4.temp="+k)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null}if(obj==null){this.callEvent("onXLS",[]);var params=[];if(typeof(this._dhxdataload.onBeforeXLS)=="function"){var k=this._dhxdataload.onBeforeXLS.apply(this,[data]);if(k!=null&&typeof(k)=="object"){if(k.url!=null){data=k.url}if(k.params!=null){for(var a in k.params){params.push(a+"="+encodeURIComponent(k.params[a]))}}}}var t=this;var callBack=function(r){var obj=null;if((r.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||(r.xmlDoc.responseText.replace(/^\s{1,}/,"")).match(/^</)!=null){obj=t[t._dhxdataload.xmlToJson].apply(t,[r.xmlDoc.responseXML])}else{try{eval("dhx4.temp="+r.xmlDoc.responseText)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null}if(obj!=null){t[t._dhxdataload.initObj].apply(t,[obj,data])}t.callEvent("onXLE",[]);if(onLoad!=null){if(typeof(onLoad)=="function"){onLoad.apply(t,[])}else{if(typeof(window[onLoad])=="function"){window[onLoad].apply(t,[])}}}callBack=onLoad=null;obj=r=t=null};params=params.join("&")+(typeof(loadParams)=="string"?"&"+loadParams:"");if(dhx4.ajax.method=="post"){dhx4.ajax.post(data,params,callBack)}else{if(dhx4.ajax.method=="get"){dhx4.ajax.get(data+(data.indexOf("?")>0?"":"")+params,callBack)}}return}}else{if(typeof(data.documentElement)=="object"||(typeof(data.tagName)!="undefined"&&typeof(data.getElementsByTagName)!="undefined"&&data.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0)){obj=this[this._dhxdataload.xmlToJson].apply(this,[data])}else{obj=window.dhx4._copyObj(data)}}if(obj!=null){this[this._dhxdataload.initObj].apply(this,[obj])}if(onLoad!=null){if(typeof(onLoad)=="function"){onLoad.apply(this,[])}else{if(typeof(window[onLoad])=="function"){window[onLoad].apply(this,[])}}onLoad=null}};if(mode!=null){var k={struct:"loadStruct",data:"load"};for(var a in mode){if(mode[a]==true){obj[k[a]]=function(){return this._loadData.apply(this,arguments)}}}}obj=null}}if(typeof(window.dhx4._eventable)=="undefined"){window.dhx4._eventable=function(a,b){if(b=="clear"){a.detachAllEvents();a.dhxevs=null;a.attachEvent=null;a.detachEvent=null;a.checkEvent=null;a.callEvent=null;a.detachAllEvents=null;a=null;return}a.dhxevs={data:{}};a.attachEvent=function(c,e){c=String(c).toLowerCase();if(!this.dhxevs.data[c]){this.dhxevs.data[c]={}}var d=window.dhx4.newId();this.dhxevs.data[c][d]=e;return d};a.detachEvent=function(f){for(var d in this.dhxevs.data){var e=0;for(var c in this.dhxevs.data[d]){if(c==f){this.dhxevs.data[d][c]=null;delete this.dhxevs.data[d][c]}else{e++}}if(e==0){this.dhxevs.data[d]=null;delete this.dhxevs.data[d]}}};a.checkEvent=function(c){c=String(c).toLowerCase();return(this.dhxevs.data[c]!=null)};a.callEvent=function(d,f){d=String(d).toLowerCase();if(this.dhxevs.data[d]==null){return true}var e=true;for(var c in this.dhxevs.data[d]){e=this.dhxevs.data[d][c].apply(this,f)&&e}return e};a.detachAllEvents=function(){for(var d in this.dhxevs.data){for(var c in this.dhxevs.data[d]){this.dhxevs.data[d][c]=null;delete this.dhxevs.data[d][c]}this.dhxevs.data[d]=null;delete this.dhxevs.data[d]}};a=null}}dhtmlx=function(c){for(var b in c){dhtmlx[b]=c[b]}return dhtmlx};dhtmlx.extend_api=function(a,d,c){var b=window[a];if(!b){return}window[a]=function(g){if(g&&typeof g=="object"&&!g.tagName){var f=b.apply(this,(d._init?d._init(g):arguments));for(var e in dhtmlx){if(d[e]){this[d[e]](dhtmlx[e])}}for(var e in g){if(d[e]){this[d[e]](g[e])}else{if(e.indexOf("on")==0){this.attachEvent(e,g[e])}}}}else{var f=b.apply(this,arguments)}if(d._patch){d._patch(this)}return f||this};window[a].prototype=b.prototype;if(c){dhtmlXHeir(window[a].prototype,c)}};dhtmlxAjax={get:function(a,c){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<3);b.waitCall=c;b.loadXML(a);return b},post:function(a,c,d){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<4);b.waitCall=d;b.loadXML(a,true,c);return b},getSync:function(a){return this.get(a,null,true)},postSync:function(a,b){return this.post(a,b,null,true)}};function dtmlXMLLoaderObject(b,d,c,a){this.xmlDoc="";if(typeof(c)!="undefined"){this.async=c}else{this.async=true}this.onloadAction=b||null;this.mainObject=d||null;this.waitCall=null;this.rSeed=a||false;return this}dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(b){var a=true;this.check=function(){if((b)&&(b.onloadAction!=null)){if((!b.xmlDoc.readyState)||(b.xmlDoc.readyState==4)){if(!a){return}a=false;dtmlXMLLoaderObject.count++;if(typeof b.onloadAction=="function"){b.onloadAction(b.mainObject,null,null,null,b)}if(b.waitCall){b.waitCall.call(this,b);b.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(c,a){if(typeof this.xmlDoc.status=="undefined"||this.xmlDoc.status<400){if(this.xmlDoc.responseXML){var b=this.xmlDoc.responseXML.getElementsByTagName(c);if(b.length==0&&c.indexOf(":")!=-1){var b=this.xmlDoc.responseXML.getElementsByTagName((c.split(":"))[1])}var d=b[0]}else{var d=this.xmlDoc.documentElement}if(d){this._retry=false;return d}if(!this._retry&&_isIE){this._retry=true;var a=this.xmlDoc;this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),true);return this.getXMLTopNode(c,a)}}dhtmlxError.throwError("LoadXML","Incorrect XML",[(a||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(b,a){if(!_isIE){var c=new DOMParser();this.xmlDoc=c.parseFromString(b,"text/xml")}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.onreadystatechange=function(){};this.xmlDoc.loadXML(b)}if(a){return}if(this.onloadAction){this.onloadAction(this.mainObject,null,null,null,this)}if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(c,b,a,d){if(this.rSeed){c+=((c.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=c;if((!_isIE)&&(window.XMLHttpRequest)){this.xmlDoc=new XMLHttpRequest()}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(b?"POST":"GET",c,this.async);if(d){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(b){this.xmlDoc.setRequestHeader("Content-type",(this.contenttype||"application/x-www-form-urlencoded"))}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||a);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this._filterXPath=null;this._getAllNamedChilds=null;this._retry=null;this.async=null;this.rSeed=null;this.filePath=null;this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;this.doXPath=null;this.doXPathOpera=null;this.doXSLTransToObject=null;this.doXSLTransToString=null;this.loadXML=null;this.loadXMLString=null;this.doSerialization=null;this.xmlNodeToJSON=null;this.getXMLTopNode=null;this.setXSLParamValue=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(d){var c={};for(var b=0;b<d.attributes.length;b++){c[d.attributes[b].name]=d.attributes[b].value}c._tagvalue=d.firstChild?d.firstChild.nodeValue:"";for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b].tagName;if(a){if(!c[a]){c[a]=[]}c[a].push(this.xmlNodeToJSON(d.childNodes[b]))}}return c};function callerFunction(a,b){this.handler=function(c){if(!c){c=window.event}a(c,b);return true};return this.handler}function getAbsoluteLeft(a){return getOffset(a).left}function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){var c=0,b=0;while(a){c=c+parseInt(a.offsetTop);b=b+parseInt(a.offsetLeft);a=a.offsetParent}return{top:c,left:b}}function getOffsetRect(d){var g=d.getBoundingClientRect();var h=document.body;var b=document.documentElement;var a=window.pageYOffset||b.scrollTop||h.scrollTop;var e=window.pageXOffset||b.scrollLeft||h.scrollLeft;var f=b.clientTop||h.clientTop||0;var i=b.clientLeft||h.clientLeft||0;var j=g.top+a-f;var c=g.left+e-i;return{top:Math.round(j),left:Math.round(c)}}function getOffset(a){if(a.getBoundingClientRect){return getOffsetRect(a)}else{return getOffsetSum(a)}}function convertStringToBoolean(a){if(typeof(a)=="string"){a=a.toLowerCase()}switch(a){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if((a||window.event)&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(a)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(c){if(!c){c=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,c);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(c,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var b=dragger.dragNode.pWindow;if(a.pWindow&&a.pWindow.dhtmlDragAndDrop.lastLanding){a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var f=document.createElement("Div");f.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=f.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=c.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=c.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!c.srcElement){var d=c.target}else{d=c.srcElement}dragger.checkLanding(d,c)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){var c=parent.frames[window.name].frameElement.offsetParent;var d=0;var b=0;while(c){d+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);d+=a.split("_")[0]*1;b+=a.split("_")[1]*1}if(e){return d+"_"+b}else{this.fx=d}this.fy=b}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(b,a){if((b)&&(b.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=b;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((b)&&(b.tagName!="BODY")){this.checkLanding(b.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(b,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:b.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(c){if(c){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(c,d){if(c){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=c.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=c.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=c.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=c.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(d))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(b){}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!c||d)?1:0))}}catch(b){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&document.compatMode!="BackCompat"){_isIE=8}}else{if(navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1){_isIE=8}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}}dtmlXMLLoaderObject.prototype.doXPath=function(c,e,d,i){if(_isKHTML||(!_isIE&&!window.XPathResult)){return this.doXPathOpera(c,e)}if(_isIE){if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(d!=null){e.setProperty("SelectionNamespaces","xmlns:xsl='"+d+"'")}if(i=="single"){return e.selectSingleNode(c)}else{return e.selectNodes(c)||new Array(0)}}else{var a=e;if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(e.nodeName.indexOf("document")!=-1){a=e}else{a=e;e=e.ownerDocument}var g=XPathResult.ANY_TYPE;if(i=="single"){g=XPathResult.FIRST_ORDERED_NODE_TYPE}var f=new Array();var b=e.evaluate(c,a,function(j){return d},g,null);if(g==XPathResult.FIRST_ORDERED_NODE_TYPE){return b.singleNodeValue}var h=b.iterateNext();while(h){f[f.length]=h;h=b.iterateNext()}return f}};function _dhtmlxError(b,a,c){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(b,a){this.catches[b]=a};_dhtmlxError.prototype.throwError=function(b,a,c){if(this.catches[b]){return this.catches[b](b,a,c)}if(this.catches.ALL){return this.catches.ALL(b,a,c)}alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(c,a){var e=c.replace(/[\/]+/gi,"/").split("/");var d=null;var b=1;if(!e.length){return[]}if(e[0]=="."){d=[a]}else{if(e[0]==""){d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(e[b].replace(/\[[^\]]*\]/g,""));b++}else{return[]}}for(b;b<e.length;b++){d=this._getAllNamedChilds(d,e[b])}if(e[b-1].indexOf("[")!=-1){d=this._filterXPath(d,e[b-1])}return d};dtmlXMLLoaderObject.prototype._filterXPath=function(e,d){var g=new Array();var d=d.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var f=0;f<e.length;f++){if(e[f].getAttribute(d)){g[g.length]=e[f]}}return g};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,d){var h=new Array();if(_isKHTML){d=d.toUpperCase()}for(var g=0;g<e.length;g++){for(var f=0;f<e[g].childNodes.length;f++){if(_isKHTML){if(e[g].childNodes[f].tagName&&e[g].childNodes[f].tagName.toUpperCase()==d){h[h.length]=e[g].childNodes[f]}}else{if(e[g].childNodes[f].tagName==d){h[h.length]=e[g].childNodes[f]}}}}return h};function dhtmlXHeir(e,d){for(var f in d){if(typeof(d[f])=="function"){e[f]=d[f]}}return e}function dhtmlxEvent(b,c,a){if(b.addEventListener){b.addEventListener(c,a,false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(b,c,d){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}var a=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+b+"']",d,"http://www.w3.org/1999/XSL/Transform","single");if(a!=null){a.firstChild.nodeValue=c}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(d,b){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(d)}var a=this.XSLProcessor.transformToDocument(b)}else{var a=new ActiveXObject("Msxml2.DOMDocument.3.0");try{b.transformNodeToObject(d,a)}catch(c){a=b.transformNode(d)}}return a};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(c,b){var a=this.doXSLTransToObject(c,b);if(typeof(a)=="string"){return a}return this.doSerialization(a)};dtmlXMLLoaderObject.prototype.doSerialization=function(b){if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){var a=new XMLSerializer();return a.serializeToString(b)}else{return b.xml}};dhtmlxEventable=function(obj){obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}};obj.detachAllEvents=function(){for(var name in this){if(name.indexOf("ev_")==0){this.detachEvent(name);this[name]=null}}};obj=null};function dhtmlXVaultObject(conf){var that=this;this.conf={version:"2.3",skin:(conf.skin||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxvault")||"dhx_skyblue"),param_name:(typeof(conf.paramName)!="undefined"?conf.paramName:"file"),engine:null,list:"list_default",url:conf.uploadUrl||"",multiple_files:(typeof(conf.multiple)!="undefined"?conf.multiple==true:true),swf_file:conf.swfPath||"",swf_url:conf.swfUrl||"",swf_logs:conf.swfLogs||"no",sl_xap:conf.slXap,sl_url:conf.slUrl,sl_logs:conf.slLogs,enabled:true,auto_start:(typeof(conf.autoStart)!="undefined"?conf.autoStart==true:true),auto_remove:(typeof(conf.autoRemove)!="undefined"?conf.autoRemove==true:false),files_added:0,uploaded_count:0,files_limit:(typeof(conf.filesLimit)!="undefined"?conf.filesLimit:0),max_file_size:0,buttons:{upload:(typeof(conf.buttonUpload)!="undefined"?(conf.buttonUpload==true):false),clear:(typeof(conf.buttonClear)!="undefined"?(conf.buttonClear==true):true)},ofs:{dhx_skyblue:5,dhx_web:7,dhx_terrace:10,bootstrap:10},uploaded_state:{},uploaded_files:{},progress_mode:"percent",icon_def:"",icons:{}};this.list=new this[this.conf.list]();this.conf.icon_def=this.icon_def;for(var a in this.icons){for(var q=0;q<this.icons[a].length;q++){this.conf.icons[this.icons[a][q]]=a}}if(typeof(conf.mode)=="string"&&typeof(this[conf.mode])=="function"){this.conf.engine=conf.mode}else{this.conf.engine="html4";var k=null;if(typeof(window.FormData)!="undefined"&&typeof(window.XMLHttpRequest)!="undefined"){k=new XMLHttpRequest();if(typeof(k.upload)=="undefined"){k=null}}if(k!=null){this.conf.engine="html5"}else{if(typeof(window.swfobject)!="undefined"||k===false){var k=swfobject.getFlashPlayerVersion();if(k.major>=10){this.conf.engine="flash"}}else{this.conf.sl_v=this.getSLVersion();if(this.conf.sl_v){this.conf.engine="sl"}}}k=null}var base=(typeof(conf.parent)!="undefined"?conf.parent:conf.container);base=(typeof(base)=="string"?document.getElementById(base):base);conf.parent=conf.container=null;if(base._attach_mode==true){this.base=base}else{this.base=document.createElement("DIV");base.appendChild(this.base)}this.base.className+=" dhx_vault_"+this.conf.skin;if(base._no_border==true){this.base.style.border="0px solid white"}base=conf=null;this.p_controls=document.createElement("DIV");this.p_controls.className="dhx_vault_controls";this.base.appendChild(this.p_controls);this.p_controls.onselectstart=function(e){e=e||event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}return false};this.p_files=document.createElement("DIV");this.p_files.className="dhx_vault_files";this.base.appendChild(this.p_files);this._doOnFilesClick=function(e){e=e||event;var t=e.target||e.srcElement;var action=null;while(t!=that.p_files&&action==null){if(action==null&&t!=null&&t._action!=null){action=t._action}else{t=t.parentNode}}if(action==null){return}if(action.data=="delete_file"){if(that.conf.enabled){that._removeFileFromQueue(action.id)}}};if(typeof(window.addEventListener)=="function"){this.p_files.addEventListener("click",this._doOnFilesClick,false)}else{this.p_files.attachEvent("onclick",this._doOnFilesClick)}this.file_data={};this._initToolbar=function(){this.b_opts={browse:{str:"btnAdd",onclick:null},upload:{str:"btnUpload",onclick:function(){if(!that.conf.enabled){return}if(!that.conf.uploading){that._uploadStart()}}},cancel:{str:"btnCancel",onclick:function(){if(!that.conf.enabled){return}that._uploadStop();that._switchButton(false)}},clear:{str:"btnClean",onclick:function(){if(!that.conf.enabled){return}that.clear()},css:"float:right!important;"}};this.buttons={};for(var a in this.b_opts){var k=document.createElement("DIV");k.innerHTML="<div class='dhxvault_button_icon dhx_vault_icon_"+a+"'></div><div class='dhxvault_button_text'>"+this.strings[this.b_opts[a].str]+"</div>";if(this.b_opts[a].css!=null){k.style.cssText+=this.b_opts[a].css}k.className="dhx_vault_button";k._css=k.className;k._onclick=this.b_opts[a].onclick;k.onmouseover=function(){if(that.conf.enabled!=true){return}if(this._hover==true){return}this._hover=true;this.className=this._css+" dhx_vault_button"+this._css_p+"_hover"};k.onmouseout=function(){if(that.conf.enabled!=true){return}if(this._hover!=true){return}this._hover=false;this.className=this._css};k.onmousedown=function(){if(that.conf.enabled!=true){return}if(this._hover!=true){return}this._pressed=true;this.className=this._css+" dhx_vault_button"+this._css_p+"_pressed"};k.onmouseup=function(e){if(that.conf.enabled!=true){return}if(this._pressed!=true){return}this._pressed=false;this.className=this._css+(this._hover?" dhx_vault_button"+this._css_p+"_hover":"");if(this._onclick!=null){this._onclick()}};if(this.b_opts[a].tooltip){k.title=this.b_opts[a].tooltip}this.p_controls.appendChild(k);this.buttons[a]=k;k=null;if(a=="upload"||a=="clear"){this.buttons[a].style.display=(this.conf.buttons[a]==true?"":"none")}this.b_opts[a].onclick=null;this.b_opts[a]=null;delete this.b_opts[a]}this.b_opts=null;delete this.b_opts;this.buttons.cancel.style.display="none"};this._readableSize=function(t){var i=false;var b=["b","Kb","Mb","Gb","Tb","Pb","Eb"];for(var q=0;q<b.length;q++){if(t>1024){t=t/1024}else{if(i===false){i=q}}}if(i===false){i=b.length-1}return Math.round(t*100)/100+" "+b[i]};this._beforeAddFileToList=function(name,size,lastModifiedDate){return(this.callEvent("onBeforeFileAdd",[{id:null,name:name,size:size,lastModifiedDate:lastModifiedDate,serverName:null,uploaded:false,error:false}])===true)};this._addFileToList=function(id,name,size,state,progress){var ext=this.getFileExtension(name);var icon=(ext.length>0?(this.conf.icons[ext.toLowerCase()]||this.conf.icon_def):this.conf.icon_def);this.list.addFileItem(id,this.p_files);this.list.renderFileRecord(id,{name:name,icon:icon,size:size,readableSize:this._readableSize(size||0),state:state,progress:progress});this.callEvent("onFileAdd",[{id:id,name:name,size:size,lastModifiedDate:this.file_data[id].file.lastModifiedDate||null,serverName:null,uploaded:false,error:false}])};this._removeFileFromList=function(id){this.list.removeFileRecord(id);if(this.conf.uploaded_files[id]!=null){this.conf.uploaded_files[id]=null;delete this.conf.uploaded_files[id]}if(this.conf.uploaded_state[id]!=null){this.conf.uploaded_state[id]=null;delete this.conf.uploaded_state[id]}};this._updateFileInList=function(id,state,progress){if(this.list.isFileItemExist(id)==false){return}if(state=="uploading"&&this.conf.progress_mode=="eta"&&this._etaStart!=null){this._etaStart(id)}this._updateProgress(id,state,progress)};this._updateProgress=function(id,state,progress){if(state=="added"){this.list.updateFileState(id,{state:state});if(this.conf.progress_mode=="eta"&&this._etaEnd!=null){this._etaEnd(id)}return}if(state=="fail"){this.list.updateFileState(id,{state:state,str_error:this.strings.error});if(this.conf.progress_mode=="eta"&&this._etaEnd!=null){this._etaEnd(id)}return}if(state=="uploaded"){if(this.conf.progress_mode=="eta"&&this._etaEnd!=null){this._etaEnd(id)}var str_done=this.strings.done;var nameSizeData=(this.conf.engine!="html4"?null:{name:this.file_data[id].name,size:this.file_data[id].size,readableSize:this._readableSize(this.file_data[id].size||0)});window.setTimeout(function(){that.list.updateFileState(id,{state:"uploaded",str_done:str_done});if(nameSizeData!=null){that.list.updateFileNameSize(id,nameSizeData)}},100);return}if(state=="uploading"){if((progress<100&&this.conf.progress_type=="loader")||this.file_data[id].custom==true){this.list.updateFileState(id,{state:"uploading_html4"})}else{if(this.conf.progress_mode=="eta"){var eta=(this._etaCheck!=null?this._etaCheck(id,progress):null);this.list.updateFileState(id,{state:"uploading",progress:progress,eta:(eta==null?null:"eta: "+eta)})}else{if(this.conf.progress_mode=="percent"){this.list.updateFileState(id,{state:"uploading",progress:progress,eta:progress+"%"})}}}}};this._removeFilesByState=function(state){for(var a in this.file_data){if(state===true||this.file_data[a].state==state){this._removeFileFromQueue(a)}}};this._switchButton=function(state){if(state==true){if(this.conf.buttons.upload==true){this.buttons.upload.style.display="none";this.buttons.cancel.style.display=""}}else{var t=this.conf.uploaded_count;var f=[];for(var a in this.conf.uploaded_state){f.push({id:a,name:this._fileName,size:(this.file_data[a]!=null?this.file_data[a].size:null),lastModifiedDate:(this.file_data[a]!=null?(this.file_data[a].file.lastModifiedDate||null):null),serverName:(this.conf.uploaded_files[a]?this.conf.uploaded_files[a].serverName:null),uploaded:this.conf.uploaded_state[a],error:!this.conf.uploaded_state[a]})}if(this.conf.buttons.upload==true){this.buttons.upload.style.display="";this.buttons.cancel.style.display="none"}this.conf.uploaded_count=0;this.conf.uploaded_state={};if(t>0){this.callEvent("onUploadComplete",[f])}}};this._uploadStart=function(){this._switchButton(true);if(!this.conf.uploading){for(var a in this.file_data){if(this.file_data[a].state=="fail"){this.file_data[a].state="added";this._updateFileInList(a,"added",0)}}}this.conf.uploading=true;var t=false;for(var a in this.file_data){if(!t&&[this.file_data[a].state]=="added"){t=true;this.file_data[a].state="uploading";this._updateFileInList(a,"uploading",0);this._doUploadFile(a)}}if(!t){this.conf.uploading=false;this._switchButton(false)}};this._onUploadSuccess=function(id,serverName,r,extra){if(typeof(r)!="undefined"&&this.conf.engine=="flash"){try{eval("dhx4.temp="+r.data)}catch(e){dhx4.temp=null}var t=dhx4.temp;dhx4.temp=null;if(t!=null&&t.state==true&&t.name!=null){serverName=t.name;if(t.extra!=null){extra=t.extra}}else{this._onUploadFail(id,(t!=null&&t.extra!=null?t.extra:null));return}}this.conf.uploaded_count++;this.conf.uploaded_files[id]={realName:this.file_data[id].name,serverName:serverName};this.file_data[id].state="uploaded";this.conf.uploaded_state[id]=true;this._updateFileInList(id,"uploaded",100);this.callEvent("onUploadFile",[{id:id,name:this.file_data[id].name,size:this.file_data[id].size,lastModifiedDate:this.file_data[id].file.lastModifiedDate||null,serverName:serverName,uploaded:true,error:false},extra]);if(this.conf.auto_remove){this._removeFileFromQueue(id)}if(this.conf.uploading){this._uploadStart()}};this._onUploadFail=function(id,extra){this.file_data[id].state="fail";this._updateFileInList(id,"fail",0);this.conf.uploaded_state[id]=false;this.callEvent("onUploadFail",[{id:id,name:this.file_data[id].name,size:this.file_data[id].size,lastModifiedDate:this.file_data[id].file.lastModifiedDate||null,serverName:null,uploaded:false,error:true},extra]);if(this.conf.uploading){this._uploadStart()}};this._onUploadAbort=function(id){this.conf.uploading=false;this.file_data[id].state="added";this._updateFileInList(id,"added",0);this.callEvent("onUploadCancel",[{id:id,name:this.file_data[id].name,size:this.file_data[id].size,lastModifiedDate:this.file_data[id].file.lastModifiedDate,serverName:null,uploaded:false,error:false}])};this.unload=function(){this.callEvent=function(){return true};if(typeof(window.addEventListener)=="function"){this.p_files.removeEventListener("click",this._doOnFilesClick,false)}else{this.p_files.detachEvent("onclick",this._doOnFilesClick)}this._removeFilesByState(true);this.conf.uploaded_files=null;this.file_data=null;this._unloadEngine();this.list.unload();this.list=null;this.icons=null;for(var a in this.buttons){this.buttons[a].onclick=null;this.buttons[a].onmouseover=null;this.buttons[a].onmouseout=null;this.buttons[a].onmousedown=null;this.buttons[a].onmouseup=null;this.buttons[a]._onclick=null;this.buttons[a].parentNode.removeChild(this.buttons[a]);this.buttons[a]=null;delete this.buttons[a]}this.buttons=null;this.p_controls.onselectstart=null;this.p_controls.parentNode.removeChild(this.p_controls);this.p_controls=null;this.p_files.parentNode.removeChild(this.p_files);this.p_files=null;window.dhx4._eventable(this,"clear");this.callEvent=null;for(var a in this.conf){this.conf[a]=null;delete this.conf[a]}this.conf=null;this.strings=null;for(var a in this){if(typeof(this[a])=="function"){this[a]=null}}if(this.base._attach_mode!=true){this.base.parentNode.removeChild(this.base)}this.base=null;that=a=null};var e=new this[this.conf.engine]();for(var a in e){this[a]=e[a];e[a]=null}a=e=p=null;this._initToolbar();this._initEngine();this.setSkin(this.conf.skin);window.dhx4._eventable(this);this.attachEvent("onFileAdd",function(){this.conf.files_added++});this.attachEvent("onBeforeFileAdd",function(){if(this.conf.files_limit==0){return true}return(this.conf.files_added<this.conf.files_limit)});if(window.dhx4.isIE7||navigator.userAgent.indexOf("MSIE 7.0")>=0){var vault=this;window.setTimeout(function(){vault.setSizes();vault=null},1)}window.dhx4.ajax.post(this.conf.url,"mode=conf",function(r){try{eval("dhx4.temp="+r.xmlDoc.responseText)}catch(e){}var t=dhx4.temp;dhx4.temp=null;if(t!=null){if(t.maxFileSize!=null){that.conf.max_file_size=parseInt(t.maxFileSize)}}});return this}dhtmlXVaultObject.prototype.icon_def="icon_def";dhtmlXVaultObject.prototype.icons={icon_image:["jpg","jpeg","gif","png","bmp","tiff","pcx","svg","ico"],icon_psd:["psd"],icon_video:["avi","mpg","mpeg","rm","move","mov","mkv","flv","f4v","mp4","3gp"],icon_audio:["wav","aiff","au","mp3","aac","wma","ogg","flac","ape","wv","m4a","mid","midi"],icon_arch:["rar","zip","tar","tgz","arj","gzip","bzip2","7z","ace","apk","deb"],icon_text:["txt","nfo","djvu","xml"],icon_html:["htm","html"],icon_doc:["doc","docx","rtf","odt"],icon_xls:["xls","xlsx"],icon_pdf:["pdf","ps"],icon_exe:["exe"],icon_dmg:["dmg"]};dhtmlXVaultObject.prototype.upload=function(){if(!this.conf.uploading){this._uploadStart()}};dhtmlXVaultObject.prototype.setAutoStart=function(a){this.conf.auto_start=(a==true)};dhtmlXVaultObject.prototype.setAutoRemove=function(a){this.conf.auto_remove=(a==true)};dhtmlXVaultObject.prototype.setURL=function(a){this.conf.url=a};dhtmlXVaultObject.prototype.enable=function(){if(this.conf.enabled==true){return}this.conf.enabled=true;this.base.className=String(this.base.className).replace(/\s{0,}dhx_vault_dis/gi,"");if(this.conf.engine=="flash"){document.getElementById(this.conf.swf_obj_id).style.display=""}};dhtmlXVaultObject.prototype.disable=function(){if(this.conf.enabled!=true){return}this.conf.enabled=false;this.base.className+=" dhx_vault_dis";if(this.conf.engine=="flash"){document.getElementById(this.conf.swf_obj_id).style.display="none"}};dhtmlXVaultObject.prototype.setWidth=function(a){if(this.base._attach_mode==true){return}this.base.parentNode.style.width=a+"px";this.setSizes()};dhtmlXVaultObject.prototype.setHeight=function(a){if(this.base._attach_mode==true){return}this.base.parentNode.style.height=a+"px";this.setSizes()};dhtmlXVaultObject.prototype.setFilesLimit=function(a){this.conf.files_added=0;this.conf.files_limit=a};dhtmlXVaultObject.prototype.getStatus=function(){var c=0;for(var b in this.file_data){if(this.file_data[b].state!="uploaded"){return -1}c=1}return c};dhtmlXVaultObject.prototype.getData=function(){var c=[];for(var b in this.conf.uploaded_files){c.push({id:b,name:this.file_data[b].name,size:this.file_data[b].size,serverName:this.conf.uploaded_files[b].serverName,uploaded:true,error:false})}return c};dhtmlXVaultObject.prototype.clear=function(){if(this.callEvent("onBeforeClear",[])!==true){return}if(this.conf.uploading){this._uploadStop()}this._switchButton(false);this._removeFilesByState(true);this.callEvent("onClear",[])};dhtmlXVaultObject.prototype.setSkin=function(c){if(c!=this.conf.skin){this.base.className=String(this.base.className).replace(new RegExp("s{0,}dhx_vault_"+this.conf.skin)," dhx_vault_"+c);this.conf.skin=c}this._updateBttonsSkin();var b=this.conf.ofs[this.conf.skin];this.buttons.browse.style.marginLeft=b+"px";this.buttons.upload.style.marginLeft=(c=="dhx_terrace"?"-1px":b+"px");this.buttons.cancel.style.marginLeft=this.buttons.upload.style.marginLeft;this.buttons.clear.style.marginRight=b+"px";var a="";if(c=="dhx_terrace"){a=(this.conf.buttons.upload==true)?"0px":"3px"}this.buttons.browse.style.borderTopRightRadius=a;this.buttons.browse.style.borderBottomRightRadius=a;this.buttons.upload.style.borderTopLeftRadius=a;this.buttons.upload.style.borderBottomLeftRadius=a;this.buttons.cancel.style.borderTopLeftRadius=this.buttons.upload.style.borderTopLeftRadius;this.buttons.cancel.style.borderBottomLeftRadius=this.buttons.upload.style.borderBottomLeftRadius;this.setSizes()};dhtmlXVaultObject.prototype._updateBttonsSkin=function(){for(var b in this.buttons){var c="dhx_vault_button";var d="";if(this.buttonCss!=null&&this.buttonCss[this.conf.skin]!=null&&this.buttonCss[this.conf.skin][b]!=null){d=this.buttonCss[this.conf.skin][b];c+=d}this.buttons[b]._css=this.buttons[b].className=c;this.buttons[b]._css_p=d}};dhtmlXVaultObject.prototype.setSizes=function(){var a=this.base.offsetWidth-(this.base.clientWidth||this.base.scrollWidth);var b=this.base.offsetHeight-this.base.clientHeight;this.base.style.width=Math.max(0,this.base.parentNode.clientWidth-a)+"px";this.base.style.height=Math.max(0,this.base.parentNode.clientHeight-b)+"px";var c=this.conf.ofs[this.conf.skin];this.p_files.style.top=this.p_controls.offsetHeight+"px";this.p_files.style.left=c+"px";if(!this.conf.ofs_f){this.p_files.style.width="100px";this.p_files.style.height="100px";this.conf.ofs_f={w:this.p_files.offsetWidth-this.p_files.clientWidth,h:this.p_files.offsetHeight-this.p_files.clientHeight}}this.p_files.style.width=Math.max(this.base.clientWidth-c*2-this.conf.ofs_f.w,0)+"px";this.p_files.style.height=Math.max(this.base.clientHeight-this.p_controls.offsetHeight-c-this.conf.ofs_f.h,0)+"px";if(typeof(this.callEvent)=="function"){this.callEvent("_onSetSizes",[])}};dhtmlXVaultObject.prototype.getFileExtension=function(b){var c="";var a=String(b).match(/\.([^\.\s]*)$/i);if(a!=null){c=a[1]}return c};dhtmlXVaultObject.prototype.strings={done:"Done",error:"Error",btnAdd:"Add files",btnUpload:"Upload",btnClean:"Clear all",btnCancel:"Cancel"};dhtmlXVaultObject.prototype.setStrings=function(e){for(var b in e){this.strings[b]=e[b]}for(var b in this.file_data){var d=this.file_data[b].state;if(d=="uploaded"||d=="fail"){this.list.updateFileState(b,{state:d,str_error:this.strings.error,str_done:this.strings.done})}}var c={browse:"btnAdd",upload:"btnUpload",clear:"btnClean",cancel:"btnCancel"};for(var b in c){this.buttons[b].childNodes[1].innerHTML=this.strings[c[b]]}};dhtmlXVaultObject.prototype.getMaxFileSize=function(){return this.conf.max_file_size};dhtmlXVaultObject.prototype.html5=function(){};dhtmlXVaultObject.prototype.html5.prototype={_initEngine:function(){var c=this;this.buttons.browse.onclick=function(){if(c.conf.enabled){c.f.click()}};this.conf.progress_type="percentage";this.conf.dnd_enabled=true;var a=window.navigator.userAgent;var b=true;if(a.match(/Windows/gi)!=null&&a.match(/AppleWebKit/gi)!=null&&a.match(/Safari/gi)!=null){if(a.match(/Version\/5\.1\.5/gi)){this.conf.multiple_files=false}if(a.match(/Version\/5\.1[^\.\d{1,}]/gi)){this.conf.dnd_enabled=false}if(a.match(/Version\/5\.1\.1/gi)){this.conf.multiple_files=false;this.conf.dnd_enabled=false}if(a.match(/Version\/5\.1\.2/gi)){this.conf.dnd_enabled=false}if(a.match(/Version\/5\.1\.7/gi)){this.conf.multiple_files=false}}this._addFileInput();if(this.conf.dnd_enabled&&this._initDND!=null){this._initDND()}},_addFileInput:function(){if(this.f!=null){this.f.onchange=null;this.f.parentNode.removeChild(this.f);this.f=null}var a=this;this.f=document.createElement("INPUT");this.f.type="file";if(this.conf.multiple_files){this.f.multiple="1"}this.f.className="dhx_vault_input";this.p_controls.appendChild(this.f);this.f.onchange=function(){a._parseFilesInInput(this.files);if(window.dhx4.isOpera){a._addFileInput()}else{this.value=""}}},_doUploadFile:function(id){if(this.file_data[id].custom==true){this._cfUploadStart(id);return}var that=this;if(!this.loader){this.loader=new XMLHttpRequest();this.loader.upload.onprogress=function(e){if(that.file_data[this._idd].state=="uploading"){that._updateFileInList(this._idd,"uploading",Math.round(e.loaded*100/e.total))}};this.loader.onload=function(e){try{eval("dhx4.temp="+this.responseText)}catch(e){}var r=dhx4.temp;dhx4.temp=null;if(r!=null&&typeof(r)=="object"&&typeof(r.state)!="undefined"&&r.state==true){that._onUploadSuccess(this.upload._idd,r.name,null,r.extra)}else{that._onUploadFail(this.upload._idd,(r!=null&&r.extra!=null?r.extra:null))}r=null};this.loader.onerror=function(e){that._onUploadFail(this.upload._idd)};this.loader.onabort=function(e){that._onUploadAbort(this.upload._idd)}}this.loader.upload._idd=id;var form=new FormData();form.append("mode","html5");if(this.file_data[id].size==0&&(navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("Trident")>0)){form.append("file_name",String(this.file_data[id].name));form.append("zero_size","1")}else{form.append(this.conf.param_name,this.file_data[id].file)}if(window.dhx4.ajax.cache!=true){form.append("dhxr"+new Date().getTime(),"")}this.loader.open("POST",this.conf.url,true);this.loader.setRequestHeader("X-Requested-With","XMLHttpRequest");this.loader.send(form)},_uploadStop:function(){if(!this.conf.uploading){return}if(this.cf_loader_id!=null){this._cfUploadStop()}else{if(this.loader!=null){this.loader.abort()}}},_parseFilesInInput:function(b){for(var a=0;a<b.length;a++){this._addFileToQueue(b[a])}},_addFileToQueue:function(a){if(!this._beforeAddFileToList(a.name,a.size,a.lastModifiedDate)){return}var b=(a._idd||window.dhx4.newId());this.file_data[b]={file:a,name:a.name,size:a.size,state:"added"};this._addFileToList(b,a.name,a.size,"added",0);if(this.conf.auto_start&&!this.conf.uploading){this._uploadStart(true)}},_removeFileFromQueue:function(e){if(!this.file_data[e]){return}var c=this.file_data[e].name;var d=(this.conf.uploaded_files!=null&&this.conf.uploaded_files[e]!=null?this.conf.uploaded_files[e].serverName:null);var b={id:Number(e),name:c,size:this.file_data[e].size,serverName:d,uploaded:(this.file_data[e].state=="uploaded"),error:(this.file_data[e].state=="fail")};if(this.callEvent("onBeforeFileRemove",[b])!==true){return}var a=false;if(this.cf_loader_id!=null||(this.conf.uploading&&this.loader!=null&&e==this.loader.upload._idd&&this.file_data[e].state=="uploading")){this._uploadStop();a=true}this.file_data[e].file=null;this.file_data[e].name=null;this.file_data[e].size=null;this.file_data[e].state=null;this.file_data[e]=null;delete this.file_data[e];this._removeFileFromList(e);this.callEvent("onFileRemove",[b]);if(a){this._uploadStart()}},_unloadEngine:function(){this.buttons.browse.onclick=null;if(this.conf.dnd_enabled&&this._unloadDND!=null){this._unloadDND()}this.f.onchange=null;this.f.parentNode.removeChild(this.f);this.f=null;if(this.loader){this.loader.upload.onprogress=null;this.loader.onload=null;this.loader.onerror=null;this.loader.onabort=null;this.loader.upload._idd=null;this.loader=null}this._initEngine=null;this._doUploadFile=null;this._uploadStop=null;this._parseFilesInInput=null;this._addFileToQueue=null;this._removeFileFromQueue=null;this._unloadEngine=null}};dhtmlXVaultObject.prototype.html4=function(){};dhtmlXVaultObject.prototype.html4.prototype={_initEngine:function(){this._addForm();this.conf.progress_type="loader";if(window.dhx4.isIE6||window.dhx4.isIE7){this.buttons.browse.style.filter=""}},_addForm:function(){var a=this;if(!this.k){this.k=document.createElement("DIV");this.k.className="dhx_vault_file_form_cont";this.buttons.browse.appendChild(this.k);this.conf.fr_name="dhx_vault_file_"+window.dhx4.newId();this.k.innerHTML='<iframe name="'+this.conf.fr_name+'" style="height:0px;width:0px;" frameBorder="0"></iframe>';this.fr=this.k.firstChild;if(window.navigator.userAgent.indexOf("MSIE")>=0){this.fr.onreadystatechange=function(){if(this.readyState=="complete"){a._onLoad()}}}else{this.fr.onload=function(){a._onLoad()}}}var b=document.createElement("DIV");b.innerHTML="<form method='POST' enctype='multipart/form-data' target='"+this.conf.fr_name+"' class='dhx_vault_file_form' name='dhx_vault_file_form_"+window.dhx4.newId()+"'><input type='hidden' name='mode' value='html4'><input type='hidden' name='uid' value=''><input type='file' name='"+this.conf.param_name+"' class='dhx_vault_file_input'></form>";this.k.appendChild(b);b.firstChild.lastChild.onchange=function(){var d=this.value.match(/[^\/\\]*$/)[0];this.previousSibling.value=this._idd=window.dhx4.newId();var c=null;var e=null;if(this.files!=null&&this.files[0]!=null){c=this.files[0].lastModifiedDate||null;e=this.files[0].size||null}if(!a._beforeAddFileToList(d,e,c)){return}a._addFileToQueue(this);this.onchange=null;this.parentNode.parentNode.style.display="none";a._addForm()};b=null},_onLoad:function(){if(this.conf.uploading&&this.fr._idd!=null){try{eval("dhx4.temp="+this.fr.contentWindow.document.body.innerHTML)}catch(e){}var r=dhx4.temp;dhx4.temp=null;if(r!=null){if(typeof(r.state)!="undefined"){if(r.state=="cancelled"){this._onUploadAbort(this.fr._idd);this.fr.contentWindow.document.body.innerHTML="";r=null;return}else{if(r.state==true){if(typeof(r.size)!="undefined"&&!isNaN(r.size)){this.file_data[this.fr._idd].size=r.size}this._onUploadSuccess(this.fr._idd,r.name,null,r.extra);r=null;return}}}}this._onUploadFail(this.fr._idd,(r!=null&&r.extra!=null?r.extra:null))}},_addFileToQueue:function(d){var b=d.value.match(/[^\\\/]*$/);if(b[0]!=null){b=b[0]}else{b=d.value}var a=null;var c=null;if(d.files!=null&&d.files[0]!=null){a=d.files[0].lastModifiedDate||null;c=d.files[0].size||null}this.file_data[d._idd]={file:{lastModifiedDate:a},name:b,size:c,form:d.parentNode,node:d.parentNode.parentNode,input:d,state:"added"};this._addFileToList(d._idd,b,(c||false),"added",0);if(this.conf.auto_start&&!this.conf.uploading){this._uploadStart(true)}},_removeFileFromQueue:function(e){var c=this.file_data[e].name;var d=(this.conf.uploaded_files!=null&&this.conf.uploaded_files[e]!=null?this.conf.uploaded_files[e].serverName:null);var b={id:Number(e),name:c,size:this.file_data[e].size||null,serverName:d,uploaded:(this.file_data[e].state=="uploaded"),error:(this.file_data[e].state=="fail")};if(this.callEvent("onBeforeFileRemove",[b])!==true){return}var a=false;if(this.file_data[e].custom==true){if(this.cf_loader_id!=null){this._uploadStop();a=true}}else{this.file_data[e].input.onchange=null;this.file_data[e].form.removeChild(this.file_data[e].input);this.file_data[e].node.removeChild(this.file_data[e].form);this.file_data[e].node.parentNode.removeChild(this.file_data[e].node);this.file_data[e].input=null;this.file_data[e].form=null;this.file_data[e].node=null}this.file_data[e].name=null;this.file_data[e].size=null;this.file_data[e].state=null;this.file_data[e]=null;delete this.file_data[e];this._removeFileFromList(e);this.callEvent("onFileRemove",[b]);if(a){this._uploadStart()}},_doUploadFile:function(a){if(this.file_data[a].custom==true){this._cfUploadStart(a)}else{this.fr._idd=a;this.file_data[a].form.action=this.conf.url;this.file_data[a].form.submit()}},_uploadStop:function(){if(!this.conf.uploading){return}if(this.cf_loader_id==null){this._onUploadAbort(this.fr._idd);this.fr.contentWindow.location.href=(this.conf.url)+(this.conf.url.indexOf("?")<0?"?":"&")+"mode=html4&action=cancel&dhxr"+new Date().getTime()}else{this._cfUploadStop()}},_unloadEngine:function(){if(this.k){this.conf.fr_name=null;this.fr.onreadystatechange=null;this.fr.onload=null;this.fr.parentNode.removeChild(this.fr);this.fr=null;this.k.firstChild.firstChild.lastChild.onchange=null;this.k.parentNode.removeChild(this.k);this.k=null}this._initEngine=null;this._addForm=null;this._onLoad=null;this._addFileToQueue=null;this._removeFileFromQueue=null;this._doUploadFile=null;this._uploadStop=null;this._unloadEngine=null}};dhtmlXVaultObject.prototype.flash=function(){};dhtmlXVaultObject.prototype.flash.prototype={_initEngine:function(){if(!window.dhtmlXVaultSWFObjects){window.dhtmlXVaultSWFObjects={items:{},callEvent:function(e,c,d){return window.dhtmlXVaultSWFObjects.items[e].uploader[c].apply(window.dhtmlXVaultSWFObjects.items[e].uploader,d)}}}var b=(window.dhx4.isIE6||window.dhx4.isIE7||navigator.userAgent.indexOf("MSIE 7.0")>=0?"opaque":"transparent");wnome="transparent";this.conf.swf_obj_id="dhxVaultSWFObject_"+window.dhx4.newId();this.conf.swf_file=this.conf.swf_file+(this.conf.swf_file.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime();if(window.dhx4.isIE){this.buttons.browse.innerHTML+="<div style='position:absolute;width:100%;height:100%;background-color:white;opacity:0;filter:alpha(opacity=0);left:0px;top:0px;'></div>";if(window.dhx4.isIE6||window.dhx4.isIE7){this.buttons.browse.style.filter=""}}this.buttons.browse.innerHTML+="<div class='dhx_vault_flash_obj'><div id='"+this.conf.swf_obj_id+"'></div></div>";swfobject.embedSWF(this.conf.swf_file,this.conf.swf_obj_id,"100%","100%","9",null,{ID:this.conf.swf_obj_id,enableLogs:this.conf.swf_logs,GVar:"dhtmlXVaultSWFObjects",paramName:this.conf.param_name,multiple:(this.conf.multiple_files?"Y":"")},{wmode:b});if((window.dhx4.isIE6||window.dhx4.isIE7)&&this.conf.skin=="dhx_skyblue"){if(this.base.parentNode!=null&&this.base.parentNode.parentNode!=null&&this.base.parentNode.parentNode.className!=null&&this.base.parentNode.parentNode.className=="dhx_cell_wins"){this.base.parentNode.parentNode.style.filter="none"}}var a=swfobject.getFlashPlayerVersion();this.conf.progress_type="percentage";window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]={id:this.conf.swf_obj_id,uploader:this}},_beforeAddFileToQueue:function(b,c,a){return(this.callEvent("onBeforeFileAdd",[{id:null,name:b,size:c,lastModifiedDate:a,serverName:null,uploaded:false,error:false}])===true?1:0)},_addFileToQueue:function(e,c,d,b){if(window.dhx4.isIE){var a=document.createElement("INPUT");a.type="TEXT";a.style.position="absolute";a.style.left="0px";a.style.top=window.dhx4.absTop(this.buttons.browse)+"px";a.style.width="10px";document.body.appendChild(a);a.focus();document.body.removeChild(a);a=null}this.file_data[e]={file:{lastModifiedDate:b},name:c,size:d,state:"added"};this._addFileToList(e,c,d,"added",0);if(this.conf.auto_start&&!this.conf.uploading){this._uploadStart(true)}},_removeFileFromQueue:function(e){if(!this.file_data[e]){return}var c=this.file_data[e].name;var d=(this.conf.uploaded_files!=null&&this.conf.uploaded_files[e]!=null?this.conf.uploaded_files[e].serverName:null);var b={id:Number(e),name:c,size:this.file_data[e].size,serverName:d,uploaded:(this.file_data[e].state=="uploaded"),error:(this.file_data[e].state=="fail")};if(this.callEvent("onBeforeFileRemove",[b])!==true){return}var a=false;if(this.conf.uploading&&this.file_data[e].state=="uploading"){this._uploadStop();a=true}swfobject.getObjectById(this.conf.swf_obj_id).removeFileById(e);this.file_data[e].name=null;this.file_data[e].size=null;this.file_data[e].state=null;this.file_data[e]=null;delete this.file_data[e];this._removeFileFromList(e);this.callEvent("onFileRemove",[b]);if(a){this._uploadStart()}},_doUploadFile:function(a){if(this.file_data[a].custom==true){this._cfUploadStart(a)}else{swfobject.getObjectById(this.conf.swf_obj_id).upload(a,this.conf.swf_url)}},_uploadStop:function(c){if(this.cf_loader_id!=null){this._cfUploadStop()}else{for(var b in this.file_data){if(this.file_data[b].state=="uploading"){swfobject.getObjectById(this.conf.swf_obj_id).uploadStop(b)}}}},_getId:function(){return window.dhx4.newId()},_unloadEngine:function(){if(window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]){window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id].id=null;window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id].uploader=null;window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]=null;delete window.dhtmlXVaultSWFObjects.items[this.conf.swf_obj_id]}this.conf.swf_obj_id=null;this._initEngine=null;this._addFileToQueue=null;this._removeFileFromQueue=null;this._doUploadFile=null;this._uploadStop=null;this._unloadEngine=null}};dhtmlXVaultObject.prototype.setSWFURL=function(a){this.conf.swf_url=a};dhtmlXVaultObject.prototype.sl=function(){};dhtmlXVaultObject.prototype.sl.prototype={_initEngine:function(){if(typeof(this.conf.sl_v)=="undefined"){this.conf.sl_v=this.getSLVersion()}if(!window.dhtmlXVaultSLObjects){window.dhtmlXVaultSLObjects={items:{},callEvent:function(c,a,b){window.dhtmlXVaultSLObjects.items[c].uploader[a].apply(window.dhtmlXVaultSLObjects.items[c].uploader,b)}}}this.conf.sl_obj_id="dhtmlXFileUploaderSLObject_"+window.dhx4.newId();if(this.conf.sl_v!=false){this.buttons.browse.innerHTML+='<div style="width:100%;height:100%;left:0px;top:0px;position:absolute;"><object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%" id="'+this.conf.sl_obj_id+'"><param name="source" value="'+this.conf.sl_xap+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="SLID='+this.conf.sl_obj_id+",LOGS="+this.conf.sl_logs+',GVAR=dhtmlXVaultSLObjects"/><param name="minRuntimeVersion" value="5.0"/></object></div>'}else{this.buttons.browse.style.cursor="wait";this.buttons.browse.title=""}this.conf.progress_type="percentage";window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]={id:this.conf.sl_obj_id,uploader:this}},_addFileToQueue:function(c,a,b){this.file_data[c]={name:a,size:b,state:"added",file:{lastModifiedDate:null}};this._addFileToList(c,a,b,"added",0);if(this.conf.auto_start&&!this.conf.uploading){this._uploadStart(true)}},_removeFileFromQueue:function(b){if(!this.file_data[b]){return}var a=false;if(this.conf.uploading&&this.file_data[b].state=="uploading"){this._uploadStop();a=true}document.getElementById([this.conf.sl_obj_id]).Content.a.removeFileById(b);this.file_data[b].name=null;this.file_data[b].size=null;this.file_data[b].state=null;this.file_data[b].file=null;this.file_data[b]=null;delete this.file_data[b];this._removeFileFromList(b);if(a){this._uploadStart()}},_doUploadFile:function(a){document.getElementById(this.conf.sl_obj_id).Content.a.upload(a,this.conf.sl_url,"&mode=sl&dhxr"+new Date().getTime())},_uploadStop:function(c){this.conf.uploading=false;for(var b in this.file_data){if(this.file_data[b].state=="uploading"){document.getElementById(this.conf.sl_obj_id).Content.a.uploadStop(b)}}},_unloadEngine:function(){if(window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]){window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id].id=null;window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id].uploader=null;window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]=null;delete window.dhtmlXVaultSLObjects.items[this.conf.sl_obj_id]}this.conf.sl_obj_id=null;this._initEngine=null;this._addFileToQueue=null;this._removeFileFromQueue=null;this._doUploadFile=null;this._uploadStop=null;this._unloadEngine=null}};dhtmlXVaultObject.prototype.setSLURL=function(a){this.conf.sl_url=a};dhtmlXVaultObject.prototype.getSLVersion=function(){var a=false;if(window.dhx4.isIE){try{var b=new ActiveXObject("AgControl.AgControl");if(b!=null){var f=4,d=0;while(b.isVersionSupported([f,d].join("."))){a=[f,d];if(++d>9){f++;d=0}}}b=null}catch(c){}}else{if(navigator.plugins["Silverlight Plug-In"]!=null){a=navigator.plugins["Silverlight Plug-In"].description.split(".")}}return a};dhtmlXVaultObject.prototype.list_default=function(){this.t={};this.addFileItem=function(c,a){var b=document.createElement("DIV");b._idd=c;a.appendChild(b);this.t[c]=b;b=a=null};this.isFileItemExist=function(a){return(this.t[a]!=null)};this.renderFileRecord=function(c,b){var a=this.t[c];if(!a==null){return}a.className="dhx_vault_file dhx_vault_file_"+b.state;a.innerHTML="<div class='dhx_vault_file_param dhx_vault_file_name'>&nbsp;</div><div class='dhx_vault_file_param dhx_vault_file_progress'>&nbsp;</div><div class='dhx_vault_file_param dhx_vault_file_delete'>&nbsp;</div><div class='dhx_vault_file_icon dhx_vault_"+b.icon+"'><div class='dhx_vault_all_icons'></div></div>";a.childNodes[2]._action={id:c,data:"delete_file"};this.updateFileNameSize(c,b);a=null};this.removeFileRecord=function(b){var a=this.t[b];if(a==null){return}a._idd=null;a.childNodes[2]._action=null;a.parentNode.removeChild(a);a=null;this.t[b]=null;delete this.t[b]};this.updateFileNameSize=function(c,b){var a=this.t[c];if(a==null){return}a.childNodes[0].innerHTML="<div class='dhx_vault_file_name_text'>"+b.name+(!isNaN(b.size)&&b.size!==false?" ("+b.readableSize+")":"&nbsp;")+"</div>";a.childNodes[0].title=b.name+(!isNaN(b.size)&&b.size!==false?" ("+b.readableSize+")":"");a=null};this.updateFileState=function(d,c){var b=this.t[d];if(b==null){return}var a=false;if(this.updateFileStateExtra!=null){a=this.updateFileStateExtra(d,c)}if(!a){if(c.state=="added"){b.className="dhx_vault_file dhx_vault_file_added";b.childNodes[1].className="dhx_vault_file_param dhx_vault_file_progress";b.childNodes[1].innerHTML="&nbsp;"}if(c.state=="fail"){b.className="dhx_vault_file dhx_vault_file_fail";b.childNodes[1].className="dhx_vault_file_param dhx_vault_file_progress";b.childNodes[1].innerHTML=c.str_error}if(c.state=="uploaded"){b.className="dhx_vault_file dhx_vault_file_uploaded";b.childNodes[1].className="dhx_vault_file_param dhx_vault_file_progress";b.childNodes[1].innerHTML=c.str_done}if(c.state=="uploading_html4"||c.state=="uploading"){b.className="dhx_vault_file dhx_vault_file_uploading";b.childNodes[1].className="dhx_vault_file_param dhx_vault_file_uploading";b.childNodes[1].innerHTML="<div class='dhx_vault_progress'><div class='dhx_vault_progress_loader'>&nbsp;</div></div>"}}b=null};this.updateStrings=function(){};this.unload=function(){this.t=null}};if(typeof(window.dhtmlXCellObject)!="undefined"&&typeof(dhtmlXCellObject.prototype.attachVault)=="undefined"){dhtmlXCellObject.prototype.attachVault=function(a){var b=document.createElement("DIV");b.style.position="relative";b.style.width="100%";b.style.height="100%";b.style.overflow="hidden";this._attachObject(b);b._attach_mode=true;b._no_border=true;if(typeof(window.dhtmlXWindowsCell)!="undefined"&&this instanceof dhtmlXWindowsCell){b._no_border=false}if(typeof(a)!="object"||a==null){a={}}a.parent=b;if(typeof(a.skin)=="undefined"){a.skin=this.conf.skin}this.dataType="vault";this.dataObj=new dhtmlXVaultObject(a);if(typeof(window.dhtmlXLayoutCell)!="undefined"&&this instanceof dhtmlXLayoutCell){this.layout._getMainInst().attachEvent("onExpand",function(d){for(var e=0;e<d.length;e++){var c=this.cells(d[e]);if(c.dataType=="vault"&&c.dataObj!=null){c.dataObj.setSizes()}c=null}})}a.parent=null;a=b=null;return this.dataObj}}dhtmlXVaultObject.prototype.buttonCss={bootstrap:{browse:"_browse",upload:"_upload",cancel:"_cancel",clear:"_clear"}};if(typeof(window.dhtmlXPopup)!="undefined"&&typeof(dhtmlXPopup.prototype.attachVault)=="undefined"){dhtmlXPopup.prototype.attachVault=function(c,a,b){return this._attachNode("vault",{width:c||350,height:a||200,conf:b||{}})};dhtmlXPopup.prototype._attach_init_vault=function(a){a.conf.parent=this._nodeId;document.getElementById(this._nodeId)._no_border=true;if(typeof(a.conf.skin)=="undefined"){a.conf.skin=this.conf.skin}this._nodeObj=new dhtmlXVaultObject(a.conf)}}dhtmlXVaultObject.prototype.load=function(a,b){if(this.conf.dataload_inited!=true){this.conf.dataload_inited=true;if(typeof(this.conf.dataload_progress)=="undefined"){this.conf.dataload_progress=true}this.attachEvent("onXLS",this._progressOn);this.attachEvent("onXLE",this._progressOff);window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","files",{data:true});this.load.apply(this,arguments)}};dhtmlXVaultObject.prototype.addFileRecord=function(b,a){if(a==null||{added:true,uploaded:true}[a]!=true){return}var c=window.dhx4.newId();if(typeof(b.name)=="undefined"||b.name==null){b.name="New File Record"}if(typeof(b.size)=="undefined"||b.size==null){b.size=false}this.file_data[c]={file:{}};this._addFileToList(c,b.name,b.size,a,0);if(a=="uploaded"){if(typeof(b.serverName)=="undefined"&&b.serverName==null){b.serverName=b.name}this.conf.uploaded_files[c]={realName:b.name,serverName:b.serverName}}this.file_data[c]={name:b.name,size:b.size,state:a,file:{},custom:true,fileData:b};this.list.updateFileState(c,{state:a,str_done:this.strings.done});if(this.conf.auto_start&&!this.conf.uploading){this._uploadStart(true)}};dhtmlXVaultObject.prototype._cfOnUpload=function(){if(this.cf_loader_id==null){return}var id=this.cf_loader_id;this.cf_loader_id=null;dhx4.temp=null;try{eval("dhx4.temp="+this.cf_loader.responseText)}catch(e){}var r=dhx4.temp;dhx4.temp=null;try{this.cf_loader.onreadystatechange=null;this.cf_loader=null}catch(e){}try{delete this.cf_loader.onreadystatechange;delete this.cf_loader}catch(e){}if(r!=null&&typeof(r)=="object"&&typeof(r.state)!="undefined"&&r.state==true){if(this.file_data[id].custom==true&&typeof(r.size)!="undefined"){this._cfUpdateSize(id,r.size)}this._onUploadSuccess(id,r.name,undefined,r.extra)}else{this._onUploadFail(id,(r!=null&&r.extra!=null?r.extra:null))}r=null};dhtmlXVaultObject.prototype._cfUpdateSize=function(d,c){this.file_data[d].size=c;var a={name:this.file_data[d].name,size:this.file_data[d].size,readableSize:this._readableSize(this.file_data[d].size||0)};var b=this;window.setTimeout(function(){b.list.updateFileNameSize(d,a);b=a=null},100)};dhtmlXVaultObject.prototype._cfUploadStart=function(e){var c=["mode=custom"];for(var b in this.file_data[e].fileData){c.push(encodeURIComponent(b)+"="+encodeURIComponent(this.file_data[e].fileData[b]))}c=c.join("&");var d=this;this.cf_loader=(window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));this.cf_loader.onreadystatechange=function(){if(d.cf_loader.readyState==4){if(d.cf_loader.status==200){d._cfOnUpload()}else{if(d.cf_loader.status==404){d._onUploadFail(d.cf_loader_id)}}d=null}};if(window.dhx4.ajax.cache!=true){c+=(c.length>0?"&":"")+"dhxr"+new Date().getTime()}this.cf_loader_id=e;this.cf_loader.open("POST",this.conf.url,true);this.cf_loader.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.cf_loader.setRequestHeader("X-Requested-With","XMLHttpRequest");this.cf_loader.send(c)};dhtmlXVaultObject.prototype._cfUploadStop=function(){var a=this.cf_loader_id;this.cf_loader_id=null;this.cf_loader.abort();this._onUploadAbort(a)};dhtmlXVaultObject.prototype._initObj=function(b){for(var a=0;a<b.length;a++){this.addFileRecord(b[a],"uploaded")}};dhtmlXVaultObject.prototype._xmlToObj=function(j){var h=[];if(!this.conf.xml_attrs){this.conf.xml_attrs={name:"name",size:"size",serverName:"serverName"}}var d=j.getElementsByTagName("files")[0];for(var g=0;g<d.childNodes.length;g++){if(d.childNodes[g].tagName!=null&&String(d.childNodes[g].tagName).toLowerCase()=="file"){var c=d.childNodes[g];var e={};for(var b in this.conf.xml_attrs){if(c.getAttribute(b)!=null){e[this.conf.xml_attrs[b]]=c.getAttribute(b)}}h.push(e);c=e=null}}return h};dhtmlXVaultObject.prototype._progressOn=function(){if(this.conf.dataload_progress==true){if(this.conf.progress_tm!=null){window.clearTimeout(this.conf.progress_tm)}if(this.p_progress==null){this.p_progress=document.createElement("DIV");this.p_progress.className="dhx_vault_f_pr";this.base.appendChild(this.p_progress);if(typeof(this.conf.progress_event)=="undefined"){this.conf.progress_event=this.attachEvent("_onSetSizes",this._progressAdjust)}this._progressAdjust()}}};dhtmlXVaultObject.prototype._progressOff=function(){var a=this;if(this.conf.progress_tm!=null){window.clearTimeout(this.conf.progress_tm)}this.conf.progress_tm=window.setTimeout(function(){if(a.p_progress!=null){a.p_progress.parentNode.removeChild(a.p_progress);a.p_progress=null}a=null},200)};dhtmlXVaultObject.prototype._progressAdjust=function(){if(this.p_progress!=null){this.p_progress.style.left=this.p_files.style.left;this.p_progress.style.top=this.p_files.style.top;this.p_progress.style.width=this.p_files.style.width;this.p_progress.style.height=this.p_files.style.height}};dhtmlXVaultObject.prototype._initDND=function(){var a=this;this.dnd={};this._showDNDBox=function(){if(!this.conf.enabled){return}if(!this.dnd.box){this.dnd.box=document.createElement("DIV");this.dnd.box.className="dhx_vault_dnd_box";this.base.appendChild(this.dnd.box);this.p_files.className="dhx_vault_files dhx_vault_dnd_box_over";this.dnd.box.style.top=this.p_files.style.top;this.dnd.box.style.left=this.p_files.style.left;this.dnd.box.style.width=this.p_files.offsetWidth-(this.dnd.box.offsetWidth-this.dnd.box.clientWidth)+"px";this.dnd.box.style.height=this.p_files.offsetHeight-(this.dnd.box.offsetHeight-this.dnd.box.clientHeight)+"px";this.dnd.box.innerHTML="<div class='dhx_vault_dnd_box_text' style='margin-top:"+Math.round(this.dnd.box.offsetHeight/2-24)+"px;'>"+this.strings.dnd+"</div>";this.dnd.box.ondragenter=function(b){a.dnd.last_node=b.target;if(!b.dataTransfer){return}try{b.dataTransfer.effectAllowed="copy";b.dataTransfer.dropEffect="copy"}catch(c){}b.stopPropagation();b.preventDefault()};this.dnd.box.ondragover=function(b){a.dnd.last_node=b.target;if(!b.dataTransfer){return}b.stopPropagation();b.preventDefault()};this.dnd.box.ondrop=function(b){if(!b.dataTransfer){return}try{b.dataTransfer.effectAllowed="copy";b.dataTransfer.dropEffect="copy"}catch(c){}b.stopPropagation();b.preventDefault();if(b.dataTransfer.files.length>0){a._parseFilesInInput(b.dataTransfer.files)}else{a.callEvent("_onNodeDrop",[b.dataTransfer])}a._hideDNDBox()}}};this._hideDNDBox=function(){if(this.dnd.box!=null){this.dnd.box.ondragenter=null;this.dnd.box.ondragover=null;this.dnd.box.ondrop=null;this.dnd.box.parentNode.removeChild(this.dnd.box);this.dnd.box=null;this.p_files.className="dhx_vault_files";this.dnd.last_node=null}};this.dnd.last_node=null;this._doOnWinDragEnter=function(b){a.dnd.last_node=b.target;a._showDNDBox()};this._doOnWinDragLeave=function(b){if(a.dnd.last_node==b.target){window.setTimeout(function(){a._hideDNDBox()},1)}};window.addEventListener("dragenter",this._doOnWinDragEnter,false);window.addEventListener("dragleave",this._doOnWinDragLeave,false);this._doOnWinDragOver=function(b){if(!b.dataTransfer){return}try{b.dataTransfer.effectAllowed="none";b.dataTransfer.dropEffect="none"}catch(c){}b.stopPropagation();b.preventDefault()};this._doOnWinDrop=function(b){if(!b.dataTransfer){return}b.stopPropagation();b.preventDefault();a._hideDNDBox()};window.addEventListener("dragover",this._doOnWinDragOver,false);window.addEventListener("drop",this._doOnWinDrop,false);this._unloadDND=function(){window.removeEventListener("dragenter",this._doOnWinDragEnter,false);window.removeEventListener("dragleave",this._doOnWinDragLeave,false);window.removeEventListener("dragover",this._doOnWinDragOver,false);window.removeEventListener("drop",this._doOnWinDrop,false);for(var b in this._dndNodesData){if(this._dndNodesData[b].inst_id==this.conf.inst_id){this.removeDraggableNode(this._dndNodesData[b].node)}}this._hideDNDBox();this._showDNDBox=null;this._hideDNDBox=null;this._doOnWinDragEnter=null;this._doOnWinDragLeave=null;this._doOnWinDragOver=null;this._doOnWinDrop=null;this._initDND=null;this._unloadDND=null;this.dnd=null;a=null}};dhtmlXVaultObject.prototype.strings.dnd="Drop files here";dhtmlXVaultObject.prototype._dndNodesData={};dhtmlXVaultObject.prototype.addDraggableNode=function(a,b){if(typeof(window.addEventListener)!="function"){return}if(typeof(a)=="string"){a=document.getElementById(a)}if(typeof(a._dhxvault_dnd_id)!="undefined"){a=null;return}if(this.conf.inst_id==null){this.conf.inst_id=window.dhx4.newId()}if(this._onNodeDragStart==null){this._onNodeDragStart=function(d){d=d||event;d.dataTransfer.setData("text",this._dhxvault_dnd_id)};this._onNodeDrop=function(d){var e=d.getData("text");if(e!=null&&this._dndNodesData[e]!=null){this.callEvent("onDrop",[this._dndNodesData[e].node,this._dndNodesData[e].data])}};this.attachEvent("_onNodeDrop",this._onNodeDrop)}var c=String(window.dhx4.newId());a._dhxvault_dnd_id=c;this._dndNodesData[c]={inst_id:this.conf.inst_id,node:a,data:b};a.addEventListener("dragstart",this._onNodeDragStart,false);a=null};dhtmlXVaultObject.prototype.removeDraggableNode=function(a){if(typeof(a)=="string"){a=document.getElementById(a)}if(typeof(a._dhxvault_dnd_id)=="undefined"){a=null;return}this._dndNodesData[a._dhxvault_dnd_id].node=null;this._dndNodesData[a._dhxvault_dnd_id].data=null;delete this._dndNodesData[a._dhxvault_dnd_id];delete a._dhxvault_dnd_id;a.removeEventListener("dragstart",this._onNodeDragStart);a=null};dhtmlXVaultObject.prototype.setProgressMode=function(a){this.conf.progress_mode=a};dhtmlXVaultObject.prototype.list_default.prototype.updateFileStateExtra=function(c,b){var a=this.t[c];if(a==null){return}if(b.state=="uploading"){a.className="dhx_vault_file dhx_vault_file_uploading";a.childNodes[1].className="dhx_vault_file_param dhx_vault_file_progress";a.childNodes[1].innerHTML="<div class='dhx_vault_progress'><div class='dhx_vault_progress_bg' style='width:"+b.progress+"%;'>&nbsp;</div></div>"+(b.eta!=null?"<span class='progress_eta'>"+b.eta+"</span>":"")}a=null;return(b.state=="uploading")};dhtmlXVaultObject.prototype._etaStart=function(a){if(typeof(this.conf.files_time)=="undefined"){this.conf.files_time={}}if(this.conf.files_time[a]==null){this.conf.files_time[a]={start:new Date().getTime(),end:0,size:this.file_data[a].size}}};dhtmlXVaultObject.prototype._etaCheck=function(g,a){var b=null;if(this.conf.files_time[g]!=null&&a>0){var c=(new Date().getTime()-this.conf.files_time[g].start)/1000;var f=(c*100/a-c).toFixed(0);var e=new Date().getTime();if((this.conf.files_time[g].time_upd==null||this.conf.files_time[g].time_upd+1100<e)&&this.conf.files_time[g].start+3000<e){this.conf.files_time[g].time_left=Math.max(1,f);this.conf.files_time[g].time_upd=e}if(this.conf.files_time[g].time_left!=null){b=this._timeHIS(this.conf.files_time[g].time_left)}}return b};dhtmlXVaultObject.prototype._etaEnd=function(a){this.conf.files_time[a]=null;delete this.conf.files_time[a]};dhtmlXVaultObject.prototype._timeHIS=function(d){var b=["h","m","s"];var e=[];var a=3600;for(var f=0;f<3;f++){var c=Math.floor(d/a);d=d-c*a;if(c>0||e.length>0){e.push(String(c)+b[f])}if(a>1){a=a/60}}return e.join(" ")};